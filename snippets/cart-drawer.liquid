<cart-drawer class="drawer{% if cart == empty %} is-empty{% endif %}">
  <div id="CartDrawer" class="cart-drawer">
    <div id="CartDrawer-Overlay" class="cart-drawer__overlay" tabindex="-1"></div>
    <div class="drawer__inner" role="dialog" aria-modal="true" aria-label="Your cart" tabindex="-1">

      <!-- HEADER -->
      <div class="drawer__header">
        <div class="drawer__header--inner">
          <button type="button" class="drawer__close" onclick="this.closest('cart-drawer').close()" aria-label="Close">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
          </button>
          <div class="drawer__heading-wrap">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 25 25" fill="none" class="drawer__cart-icon">
              <path d="M3 4.75C3 4.55109 3.079 4.36032 3.22 4.21967C3.36 4.07902 3.551 4 3.75 4H4.308C5.258 4 5.828 4.639 6.153 5.233C6.37 5.629 6.527 6.088 6.65 6.504L6.75 6.5H19.248C20.078 6.5 20.678 7.294 20.45 8.093L18.622 14.502C18.458 15.077 18.111 15.583 17.634 15.943C17.157 16.303 16.576 16.498 15.978 16.498H10.03C9.428 16.498 8.842 16.3 8.363 15.935C7.883 15.57 7.538 15.057 7.378 14.476L5.358 7.456L5.357 7.448C5.201 6.881 5.055 6.35 4.837 5.954C4.628 5.569 4.46 5.5 4.309 5.5H3.75C3.551 5.5 3.36 5.421 3.22 5.28C3.079 5.14 3 4.949 3 4.75ZM9.5 19.5a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm9 0a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z" fill="currentColor"/>
            </svg>
            <span class="drawer__heading">YOUR CART</span>
            {%- if cart != empty -%}
              <span class="drawer__item-count">{{ cart.item_count }}</span>
            {%- endif -%}
          </div>
        </div>
      </div>

      {%- if cart == empty -%}
        <div class="drawer__inner-empty">
          <div class="cart-drawer__warnings">
            <svg xmlns="http://www.w3.org/2000/svg" width="56" height="56" viewBox="0 0 25 25" fill="none" opacity="0.25">
              <path d="M3 4.75C3 4.55109 3.079 4.36032 3.22 4.21967C3.36 4.07902 3.551 4 3.75 4H4.308C5.258 4 5.828 4.639 6.153 5.233C6.37 5.629 6.527 6.088 6.65 6.504L6.75 6.5H19.248C20.078 6.5 20.678 7.294 20.45 8.093L18.622 14.502C18.458 15.077 18.111 15.583 17.634 15.943C17.157 16.303 16.576 16.498 15.978 16.498H10.03C9.428 16.498 8.842 16.3 8.363 15.935C7.883 15.57 7.538 15.057 7.378 14.476L5.358 7.456L5.357 7.448C5.201 6.881 5.055 6.35 4.837 5.954C4.628 5.569 4.46 5.5 4.309 5.5H3.75C3.551 5.5 3.36 5.421 3.22 5.28C3.079 5.14 3 4.949 3 4.75ZM9.5 19.5a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm9 0a2 2 0 1 1-4 0 2 2 0 0 1 4 0Z" fill="#fff"/>
            </svg>
            <h2 class="cart__empty-text">Your cart is empty</h2>
            <p class="cart__empty-sub">Add something dark &amp; beautiful</p>
            <a href="{{ routes.all_products_collection_url }}" class="button lv-btn-primary">Shop Now</a>
          </div>
        </div>
      {%- endif -%}

      <!-- BODY -->
      <div class="drawer__body">
        <cart-drawer-items {% if cart == empty %}class="is-empty"{% endif %}>
          <form action="{{ routes.cart_url }}" id="CartDrawer-Form" method="post">
            <div id="CartDrawer-CartItems" class="drawer__contents js-contents">
              <div class="drawer__cart-items-wrapper">
                <div class="cart-items">
                  {%- for item in cart.items -%}
                    {%- assign show_compare = false -%}
                    {%- assign compare_price = 0 -%}
                    {%- assign sale_price = item.final_price -%}
                    {%- if item.original_price != item.final_price -%}
                      {%- assign show_compare = true -%}
                      {%- assign compare_price = item.original_price -%}
                    {%- elsif item.variant.compare_at_price > item.variant.price -%}
                      {%- assign show_compare = true -%}
                      {%- assign compare_price = item.variant.compare_at_price -%}
                    {%- endif -%}

                    <div id="CartDrawer-Item-{{ forloop.index }}" class="cart--item" data-index="{{ forloop.index }}">
                      <figure>
                        {%- if item.image -%}
                          <a href="{{ item.url }}" tabindex="-1">
                            <img class="cart-item__image"
                              src="{{ item.image | image_url: width: 300 }}"
                              alt="{{ item.image.alt | escape }}"
                              loading="lazy" width="150" height="150">
                          </a>
                        {%- endif -%}
                      </figure>

                      <div class="cart-item__details">
                        <div class="cart-item__details-top">
                          <a href="{{ item.product.url }}" class="cart-item__name">{{ item.product.title | escape }}</a>
                          <cart-remove-button id="CartDrawer-Remove-{{ forloop.index }}" data-index="{{ forloop.index }}">
                            <button type="button" class="cart-remove-button button button--tertiary"
                              aria-label="Remove {{ item.product.title | escape }}"
                              data-variant-id="{{ item.variant_id }}">
                              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 25 25" fill="none">
                                <path d="M19.53 18.72a.75.75 0 01-1.06 1.06L12.25 13.56 6.03 19.78a.75.75 0 01-1.06-1.06L11.19 12.5 4.97 6.28a.75.75 0 011.06-1.06L12.25 11.44l6.22-6.22a.75.75 0 011.06 1.06L13.31 12.5l6.22 6.22z" fill="currentColor"/>
                              </svg>
                            </button>
                          </cart-remove-button>
                        </div>

                        <div class="cart-item__details-bottom">
                          <div class="loading-overlay hidden">
                            <div class="loading-overlay__spinner">
                              <svg aria-hidden="true" focusable="false" class="spinner" viewBox="0 0 66 66" xmlns="http://www.w3.org/2000/svg">
                                <circle class="path" fill="none" stroke-width="6" cx="33" cy="33" r="30"></circle>
                              </svg>
                            </div>
                          </div>

                          <div class="cart-item__price-wrapper">
                            {%- if show_compare -%}
                              <div class="cart-item__discounted-prices">
                                <span class="cart-item__sale-price">{{ sale_price | money_without_trailing_zeros }}</span>
                                <s class="cart-item__old-price">{{ compare_price | money_without_trailing_zeros }}</s>
                                {%- assign disc = compare_price | minus: sale_price | times: 100 | divided_by: compare_price -%}
                                <span class="lv-disc-badge">{{ disc }}% OFF</span>
                              </div>
                            {%- else -%}
                              <span class="cart-item__sale-price">{{ sale_price | money_without_trailing_zeros }}</span>
                            {%- endif -%}
                          </div>

                          <div class="cart-item__quantity-wrapper">
                            <div class="quantity-popover-container">
                              <quantity-input class="quantity cart-quantity">
                                <button class="quantity__button" name="minus" type="button">
                                  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" fill="none" viewBox="0 0 10 2" width="10" height="2">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M.5 1C.5.7.7.5 1 .5h8a.5.5 0 110 1H1A.5.5 0 01.5 1z" fill="currentColor"/>
                                  </svg>
                                </button>
                                <input class="quantity__input"
                                  type="number"
                                  data-quantity-variant-id="{{ item.variant_id }}"
                                  name="updates[]"
                                  value="{{ item.quantity }}"
                                  data-cart-quantity="{{ item.quantity }}"
                                  min="0" step="1"
                                  aria-label="Quantity for {{ item.product.title | escape }}"
                                  id="Drawer-quantity-{{ forloop.index }}"
                                  data-index="{{ forloop.index }}"
                                  readonly>
                                <button class="quantity__button" name="plus" type="button">
                                  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" fill="none" viewBox="0 0 10 10" width="10" height="10">
                                    <path fill-rule="evenodd" clip-rule="evenodd" d="M1 4.51a.5.5 0 000 1h3.5l.01 3.5a.5.5 0 001-.01V5.5l3.5-.01a.5.5 0 00-.01-1H5.5L5.49.99a.5.5 0 00-1 .01v3.5l-3.5.01H1z" fill="currentColor"/>
                                  </svg>
                                </button>
                              </quantity-input>
                            </div>
                            <div id="CartDrawer-LineItemError-{{ forloop.index }}" class="cart-item__error" role="alert" hidden>
                              <small class="cart-item__error-text"></small>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  {%- endfor -%}
                </div>
              </div>
            </div>

            <p id="CartDrawer-LiveRegionText" class="visually-hidden" role="status" aria-hidden="true"></p>
            <p id="CartDrawer-LineItemStatus" class="visually-hidden" aria-hidden="true" role="status">Loading...</p>
            <div id="CartDrawer-CartErrors" role="alert"></div>
          </form>

        </cart-drawer-items>
      </div><!-- end drawer__body -->

      <!-- FOOTER -->
      <div class="drawer__footer" id="CartDrawer-Footer">

        {%- comment -%}SAVINGS STRIP â€” pure Liquid, always correct after re-render{%- endcomment -%}
        {%- assign total_savings = 0 -%}
        {%- for item in cart.items -%}
          {%- if item.variant.compare_at_price > item.variant.price -%}
            {%- assign item_savings = item.variant.compare_at_price | minus: item.variant.price | times: item.quantity -%}
            {%- assign total_savings = total_savings | plus: item_savings -%}
          {%- endif -%}
          {%- if item.original_line_price > item.final_line_price -%}
            {%- assign line_savings = item.original_line_price | minus: item.final_line_price -%}
            {%- assign total_savings = total_savings | plus: line_savings -%}
          {%- endif -%}
        {%- endfor -%}
        {%- if total_savings > 0 -%}
          <div class="lv-savings-strip">
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 24 24">
              <path d="M12 22l-8-4V6l8-4 8 4v12l-8 4z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
            </svg>
            You are saving <strong>{{ total_savings | money_without_trailing_zeros }}</strong> on this order
          </div>
        {%- endif -%}

        <div class="cart-footer__totals">
          <div class="cart-footer__price-block">
            <small class="cart-footer__price-label">Total</small>
            <span class="cart-footer__price-value">{{ cart.total_price | money_with_currency }}</span>
          </div>
          <button type="submit" id="CartDrawer-Checkout" class="cart__checkout-button"
            name="checkout" form="CartDrawer-Form">
            <span class="lv-checkout-text">Checkout</span>
            <span class="lv-checkout-icons">
              <img src="https://cdn.gokwik.co/v4/images/upi-icons.svg" alt="UPI" height="16" loading="lazy">
              <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="none" viewBox="0 0 24 24">
                <path d="M5 12h14M12 5l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
            </span>
          </button>
        </div>

        <div class="cart-trust-strip">
          <div class="cart-trust-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 24 24">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
            </svg>
            <span>Secure Pay</span>
          </div>
          <span class="cart-trust-dot"></span>
          <div class="cart-trust-item">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="none" viewBox="0 0 24 24">
              <path d="M20 7H4a2 2 0 00-2 2v6a2 2 0 002 2h16a2 2 0 002-2V9a2 2 0 00-2-2z" stroke="currentColor" stroke-width="1.5"/><path d="M1 10h4M19 10h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <span>UPI &amp; Cards</span>
          </div>
        </div>

      </div><!-- end drawer__footer -->

    </div><!-- end drawer__inner -->
  </div><!-- end CartDrawer -->
</cart-drawer>
